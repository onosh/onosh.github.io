
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Détecter la désauthentification - onosh.github.io</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="black" data-md-color-accent="purple">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#detecter-la-desauthentification" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="onosh.github.io" class="md-header__button md-logo" aria-label="onosh.github.io" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            onosh.github.io
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Détecter la désauthentification
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="onosh.github.io" class="md-nav__button md-logo" aria-label="onosh.github.io" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    onosh.github.io
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome !
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Le wiki
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Le wiki" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Le wiki
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" checked>
      
      <label class="md-nav__link" for="__nav_2_1">
        Wifi
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Wifi" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Wifi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Détecter la désauthentification
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Détecter la désauthentification
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lattaque-par-desauthentification" class="md-nav__link">
    L'attaque par désauthentification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comment-detecter-cette-attaque" class="md-nav__link">
    Comment détecter cette attaque ?
  </a>
  
    <nav class="md-nav" aria-label="Comment détecter cette attaque ?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequis" class="md-nav__link">
    Prérequis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poc" class="md-nav__link">
    PoC
  </a>
  
    <nav class="md-nav" aria-label="PoC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mise-en-place" class="md-nav__link">
    Mise en place
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecoute-du-reseau" class="md-nav__link">
    Ecoute du réseau
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detection" class="md-nav__link">
    Détection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatisation" class="md-nav__link">
    Automatisation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comment-se-proteger" class="md-nav__link">
    Comment se protéger ?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    Sources
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Capture The Flag
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Capture The Flag" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Capture The Flag
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      <label class="md-nav__link" for="__nav_3_1">
        2020
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="2020" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          2020
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_1" type="checkbox" id="__nav_3_1_1" >
      
      <label class="md-nav__link" for="__nav_3_1_1">
        BSIDESBOS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="BSIDESBOS" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_1">
          <span class="md-nav__icon md-icon"></span>
          BSIDESBOS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_1_1" type="checkbox" id="__nav_3_1_1_1" >
      
      <label class="md-nav__link" for="__nav_3_1_1_1">
        Forensic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Forensic" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_1_1">
          <span class="md-nav__icon md-icon"></span>
          Forensic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/bsidesbos/spycam/" class="md-nav__link">
        Spy Cam
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_2" type="checkbox" id="__nav_3_1_2" >
      
      <label class="md-nav__link" for="__nav_3_1_2">
        European Cyber Week
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="European Cyber Week" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          European Cyber Week
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_2_1" type="checkbox" id="__nav_3_1_2_1" >
      
      <label class="md-nav__link" for="__nav_3_1_2_1">
        Forensic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Forensic" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_2_1">
          <span class="md-nav__icon md-icon"></span>
          Forensic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/ecw2020/forensicqualification/" class="md-nav__link">
        Maker is dead
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_3" type="checkbox" id="__nav_3_1_3" >
      
      <label class="md-nav__link" for="__nav_3_1_3">
        ESN'HACK
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ESN'HACK" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_3">
          <span class="md-nav__icon md-icon"></span>
          ESN'HACK
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_3_1" type="checkbox" id="__nav_3_1_3_1" >
      
      <label class="md-nav__link" for="__nav_3_1_3_1">
        Forensic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Forensic" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_3_1">
          <span class="md-nav__icon md-icon"></span>
          Forensic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/esnhack2020/exfiltration1/" class="md-nav__link">
        Exfiltration 1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/esnhack2020/exfiltration2/" class="md-nav__link">
        Exfiltration 2
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_4" type="checkbox" id="__nav_3_1_4" >
      
      <label class="md-nav__link" for="__nav_3_1_4">
        France Cybersecurity Challenge
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="France Cybersecurity Challenge" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_1_4">
          <span class="md-nav__icon md-icon"></span>
          France Cybersecurity Challenge
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_4_1" type="checkbox" id="__nav_3_1_4_1" >
      
      <label class="md-nav__link" for="__nav_3_1_4_1">
        Crypto
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Crypto" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_4_1">
          <span class="md-nav__icon md-icon"></span>
          Crypto
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/leratconteur/" class="md-nav__link">
        Le rat conteur
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_4_2" type="checkbox" id="__nav_3_1_4_2" >
      
      <label class="md-nav__link" for="__nav_3_1_4_2">
        Forensic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Forensic" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_4_2">
          <span class="md-nav__icon md-icon"></span>
          Forensic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/cappcap/" class="md-nav__link">
        CapPcap
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/findme/" class="md-nav__link">
        Find Me
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/rentree/" class="md-nav__link">
        1. La rentrée
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/artefacts/" class="md-nav__link">
        2. Artefacts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/derobe/" class="md-nav__link">
        3. Porte dérobée
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/administration/" class="md-nav__link">
        4. Administration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/chapardeur/" class="md-nav__link">
        Chapardeur
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1_4_3" type="checkbox" id="__nav_3_1_4_3" >
      
      <label class="md-nav__link" for="__nav_3_1_4_3">
        Misc
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Misc" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_1_4_3">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ctf/fcsc2020/randomito/" class="md-nav__link">
        Randomito
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lattaque-par-desauthentification" class="md-nav__link">
    L'attaque par désauthentification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comment-detecter-cette-attaque" class="md-nav__link">
    Comment détecter cette attaque ?
  </a>
  
    <nav class="md-nav" aria-label="Comment détecter cette attaque ?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequis" class="md-nav__link">
    Prérequis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poc" class="md-nav__link">
    PoC
  </a>
  
    <nav class="md-nav" aria-label="PoC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mise-en-place" class="md-nav__link">
    Mise en place
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecoute-du-reseau" class="md-nav__link">
    Ecoute du réseau
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detection" class="md-nav__link">
    Détection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatisation" class="md-nav__link">
    Automatisation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comment-se-proteger" class="md-nav__link">
    Comment se protéger ?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sources" class="md-nav__link">
    Sources
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="detecter-la-desauthentification">Détecter la désauthentification</h1>
<h2 id="lattaque-par-desauthentification">L'attaque par désauthentification</h2>
<p>Une attaque de désauthentification Wi-Fi est un type d'attaque par déni de service qui cible la communication entre un utilisateur et un point d'accès sans fil Wi-Fi.</p>
<p>La raison qui pousse les pirates à effectuer ce genre d'attaque est qu'elle permet aussi d'éxécuter une attaque par dictionnaire contre la clé WPA2 du point d'accès.</p>
<p>L'envoi d'un paquet Deauth force le périphérique ciblé à se déconnecter et à se reconnecter, le pirate peut donc capturer le handshake entre votre appareil et le point d'accès et tenter de devinez votre clé secrète.</p>
<h2 id="comment-detecter-cette-attaque">Comment détecter cette attaque ?</h2>
<h3 id="prerequis">Prérequis</h3>
<ul>
<li>Un système linux équipe de deux cartes wifi (2 physiques ou 1 physique + 1 virtuelle)</li>
<li>L'outil tshark</li>
<li>L'outil screen</li>
<li>L'outil aircrack-ng</li>
<li>Un point d'accès wifi à analyser</li>
</ul>
<h2 id="poc">PoC</h2>
<h3 id="mise-en-place">Mise en place</h3>
<p>Sur votre linux, commencez par lister les interfaces wifi disponible :</p>
<pre><code>root@kali-onosh:~# iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0     IEEE 802.11  ESSID:&quot;notSoSecure&quot;  
          Mode:Managed  Frequency:5.52 GHz  Access Point: 2E-D6-29-4E-2B-C9&quot;   
          Bit Rate=866.7 Mb/s   Tx-Power=22 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:on
          Link Quality=59/70  Signal level=-51 dBm  
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:94   Missed beacon:0

wlan1     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short  long limit:2   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off

</code></pre>
<p>Ici, je vais utiliser l'interface wlan1 pour écouter les fréquences 802.11.
Activation du mode "monitor" :</p>
<pre><code>root@kali-onosh:~# airmon-ng start wlan1

PHY Interface   Driver      Chipset

phy0    wlan0       iwlwifi     Intel Corporation Wireless-AC 9560 [Jefferson Peak] (rev 10)
phy1    wlan1       rt2800usb   Ralink Technology, Corp. RT5370

        (mac80211 monitor mode vif enabled for [phy1]wlan1 on [phy1]wlan1mon)
        (mac80211 station mode vif disabled for [phy1]wlan1)
</code></pre>
<p>Vérification de l'activation du mode monitor :</p>
<pre><code>root@kali-onosh:~# iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0     IEEE 802.11  ESSID:&quot;notSoSecure&quot;  
          Mode:Managed  Frequency:5.52 GHz  Access Point: 2E-D6-29-4E-2B-C9&quot;   
          Bit Rate=866.7 Mb/s   Tx-Power=22 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:on
          Link Quality=57/70  Signal level=-53 dBm  
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:129   Missed beacon:0

wlan1mon  IEEE 802.11  Mode:Monitor  Frequency:2.457 GHz  Tx-Power=20 dBm   
          Retry short  long limit:2   RTS thr:off   Fragment thr:off
          Power Management:off
</code></pre>
<h3 id="ecoute-du-reseau">Ecoute du réseau</h3>
<p>On récupère le BSSID qui est l'adresse physique du point d'accès.
Ici ma box internet est représenté par le SSID "notSoSecure" et le BSSID "2E-D6-29-4E-2B-C9".</p>
<pre><code>root@kali-onosh:~# airodump-ng wlan1mon

CH 13 ][ Elapsed: 30 s ][ 2020-08-05 16:55 

 BSSID              PWR  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID

 2E-D6-29-4E-2B-C9  -17       20        0    0   6  180   WPA2 CCMP   PSK  notSoSecure                                                                             
 BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes
</code></pre>
<p>On va maintenant tenter d'intercepter des trames de désauthentification.</p>
<p>Pour cela, j'utilise tshark en écoute sur mon interface <code>wlan1mon</code> en mode "monitor" et je cherche à intercepter les trames à destination de mon point d'accès via les filtres :</p>
<ul>
<li><code>wlan.fc.type_subtype==0x000c</code> pour cibler les trames de <a href="https://www.semfionetworks.com/uploads/2/9/8/3/29831147/wireshark_802.11_filters_-_reference_sheet.pdf">désauthentification</a></li>
<li>wlan.bssid==2E-D6-29-4E-2B-C9" pour cibler les trames à destination de ma box internet</li>
</ul>
<p>Je décide d'afficher :</p>
<ul>
<li><code>-e frame.time</code> l'heure de l'interception de la requête</li>
<li><code>-e wlan.fc.type_subtype</code> le type de la requête</li>
</ul>
<p>Lancement de l'écoute tshark :</p>
<p><code>tshark -i wlan1mon -Y "wlan.fc.type_subtype==0x000c &amp;&amp; wlan.bssid==2E-D6-29-4E-2B-C9" -Tfields -e frame.time -e wlan.fc.type_subtype</code></p>
<h3 id="detection">Détection</h3>
<p>Pour obtenir un résultat sur notre écoute, il faut qu'il y est une attaque.
Je lance donc une attaque de désauthentification sur ma box internet :</p>
<pre><code>root@kali-onosh:~# aireplay-ng -0 0 -a 2E-D6-29-4E-2B-C9 wlan1mon
19:43:43  Waiting for beacon frame (BSSID: 2E-D6-29-4E-2B-C9) on channel 1
19:43:43  Sending DeAuth (code 7) to broadcast -- BSSID: [2E-D6-29-4E-2B-C9]
19:43:43  Sending DeAuth (code 7) to broadcast -- BSSID: [2E-D6-29-4E-2B-C9]
19:43:43  Sending DeAuth (code 7) to broadcast -- BSSID: [2E-D6-29-4E-2B-C9]
19:43:44  Sending DeAuth (code 7) to broadcast -- BSSID: [2E-D6-29-4E-2B-C9]
19:43:44  Sending DeAuth (code 7) to broadcast -- BSSID: [2E-D6-29-4E-2B-C9]
</code></pre>
<p>Dans la fenetre tshark, des trames apparaissent, une attaque de désauthentification est détectée :</p>
<pre><code>root@kali-onosh:/tmp# tshark -i wlan1mon -Y &quot;wlan.fc.type_subtype==0x000c &amp;&amp; wlan.bssid==2E-D6-29-4E-2B-C9&quot; -Tfields -e frame.time -e wlan.fc.type_subtype
Aug  5, 2020 19:43:44.036371884 CEST    12
Aug  5, 2020 19:43:44.037317185 CEST    12
Aug  5, 2020 19:43:44.039473994 CEST    12
Aug  5, 2020 19:43:44.039561466 CEST    12
Aug  5, 2020 19:43:44.040821915 CEST    12
Aug  5, 2020 19:43:44.041637914 CEST    12
Aug  5, 2020 19:43:44.043805498 CEST    12
Aug  5, 2020 19:43:44.043887243 CEST    12
Aug  5, 2020 19:43:44.045101487 CEST    12
Aug  5, 2020 19:43:44.045982570 CEST    12
Aug  5, 2020 19:43:44.048169640 CEST    12
Aug  5, 2020 19:43:44.048245202 CEST    12
Aug  5, 2020 19:43:44.049446535 CEST    12

</code></pre>
<h3 id="automatisation">Automatisation</h3>
<p>Pour automatiser le processus, j'ai écris le script ci-dessous.
Il y a très certainement moyen de l'améliorer.</p>
<p>Voici les tâches qu'il effectue :</p>
<ul>
<li>Création d'un fichier pour l'interception des trames <code>deauth.cap</code></li>
<li>Ecoute du réseau sur le BSSID ciblé</li>
<li>Lorsqu'une trame de désauthentification est détectée, le programme analyse le nombre de trames détecté car il peut y avoir des faux positifs. Après quelques tests j'ai mis au point 3 critères :<ul>
<li>Plus de 5 trames = attaque en cours</li>
<li>Entre 1 et 5 trames = faux positif (un de vos appareil se déconnecte normalement)</li>
<li>0 trames = pas d'attaque en cours</li>
</ul>
</li>
</ul>
<pre><code>#!/bin/bash

if [ -f &quot;/tmp/deauth.cap&quot; ]; then
    rm /tmp/deauth.cap
    touch /tmp/deauth.cap
else 
    touch /tmp/deauth.cap
fi

screen -dm bash -c 'tshark -i wlan1mon -Y &quot;wlan.fc.type_subtype==0x000c &amp;&amp; wlan.bssid==2E-D6-29-4E-2B-C9&quot; -Tfields -e frame.time -e wlan.fc.type_subtype &gt;/tmp/deauth.cap'

tail -fn0 /tmp/deauth.cap | \
while read line ; do
    instant=$( echo $( date +&quot;%b\ \  %-d, %Y %H:%M:&quot;) )
    date=$( date )
    nb=$( grep -i &quot;$instant&quot; /tmp/deauth.cap |wc -l )

    if (( $nb &gt; 5 )); then
        echo $date&quot; DEAUTH ATTAK DETECTED - $nb frames&quot; &amp;&amp; echo $date&quot; DEAUTH ATTACK DETECTED - $nb frames&quot; &gt;/tmp/deauth.log
        sleep 2
    elif (( $nb &gt; 0 &amp;&amp; $nb &lt;= 5 )); then
        echo $date&quot; DEAUTH FALSE POSITIVE DETECTED - $nb frames&quot; &amp;&amp; echo $date&quot; DEAUTH FALSE POSITIVE DETECTED - $nb frames&quot; &gt;/tmp/deauth.log
        sleep 2
    else
        echo $date&quot; DEAUTH NO ATTACK DETECTED - $nb frames&quot;
        sleep 2
    fi
done
</code></pre>
<p>Le script vous donne quelques logs :</p>
<pre><code>Wed 5 Aug 19:43:56 CEST 2020 DEAUTH ATTAKC DETECTED - 205 frames
Wed 5 Aug 19:43:58 CEST 2020 DEAUTH ATTACK DETECTED - 205 frames
Wed 5 Aug 19:44:00 CEST 2020 DEAUTH NO ATTACK DETECTED - 0 frames
Wed 5 Aug 19:44:02 CEST 2020 DEAUTH NO ATTACK DETECTED - 0 frames
Wed 5 Aug 19:44:04 CEST 2020 DEAUTH NO ATTACK DETECTED - 0 frames
Wed 5 Aug 19:44:06 CEST 2020 DEAUTH NO ATTACK DETECTED - 0 frames

</code></pre>
<h2 id="comment-se-proteger">Comment se protéger ?</h2>
<p>Aujourd'hui je ne connais pas de moyen pour proteger efficacement sa bonne vieille box internet des attaques par désauthentification.
Pour ralentir le hacker, il est quand même possible d'utiliser une clé WPA2 solide comme celle ci par exemple : <code>vZbhJ]EN}F}v$(fhs~(3VC6m;s@Tk^v5</code></p>
<p>Le script ci-dessus permet quant à lui de détecter ces attaques, peut-être que vous reussirez à créer quelques choses pour encore mieux vous défendre maintenant ?</p>
<h2 id="sources">Sources</h2>
<p>https://www.sans.org/reading-room/whitepapers/wireless/80211-denial-service-attacks-mitigation-2108</p>
<hr />
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../.." class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Précédent
              </span>
              Welcome !
            </div>
          </div>
        </a>
      
      
        <a href="../../ctf/bsidesbos/spycam/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Suivant
              </span>
              Spy Cam
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2019 - 2021 onosh
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/onosh__" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://fr.linkedin.com/in/f-demay" target="_blank" rel="noopener" title="fr.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/onosh" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "search.suggest", "search.highlight", "search.share"], "translations": {"clipboard.copy": "Copier dans le presse-papier", "clipboard.copied": "Copi\u00e9 dans le presse-papier", "search.config.lang": "fr", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Rechercher", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>